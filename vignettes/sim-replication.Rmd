---
title: "Single Replication from the Simulation Study"
author: "Ivan Jacob Agaloos Pesigan"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Single Replication from the Simulation Study}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---




``` r
library(manCULTA)
```

## Data Generation


``` r
seed <- 1
set.seed(seed)
taskid <- 1
data <- GenData(taskid = taskid)
summary(as.matrix(data))
#>        id           covariate           y1t0               y2t0         
#>  Min.   :  1.00   Min.   :-1.476   Min.   :-2.95531   Min.   :-3.32957  
#>  1st Qu.: 25.75   1st Qu.: 8.940   1st Qu.:-0.88530   1st Qu.:-0.92863  
#>  Median : 50.50   Median :10.956   Median :-0.24502   Median :-0.06853  
#>  Mean   : 50.50   Mean   :11.423   Mean   :-0.03084   Mean   :-0.02084  
#>  3rd Qu.: 75.25   3rd Qu.:14.841   3rd Qu.: 0.48148   3rd Qu.: 0.63261  
#>  Max.   :100.00   Max.   :20.817   Max.   : 4.60668   Max.   : 3.41156  
#>       y3t0               y4t0               y1t1               y2t1          
#>  Min.   :-3.01819   Min.   :-3.03379   Min.   :-2.27336   Min.   :-2.885316  
#>  1st Qu.:-0.94304   1st Qu.:-0.83925   1st Qu.:-0.70568   1st Qu.:-0.730919  
#>  Median :-0.11954   Median :-0.08115   Median :-0.21152   Median :-0.154768  
#>  Mean   :-0.03995   Mean   : 0.03430   Mean   : 0.07722   Mean   : 0.006064  
#>  3rd Qu.: 0.80792   3rd Qu.: 0.87367   3rd Qu.: 0.59719   3rd Qu.: 0.658050  
#>  Max.   : 4.07943   Max.   : 2.82824   Max.   : 3.75899   Max.   : 3.548263  
#>       y3t1               y4t1               y1t2               y2t2         
#>  Min.   :-2.48755   Min.   :-2.86318   Min.   :-2.06595   Min.   :-1.79053  
#>  1st Qu.:-0.90966   1st Qu.:-0.72175   1st Qu.:-0.64926   1st Qu.:-0.69986  
#>  Median :-0.11940   Median :-0.07472   Median :-0.17913   Median :-0.10516  
#>  Mean   :-0.03278   Mean   : 0.10189   Mean   : 0.03056   Mean   :-0.01833  
#>  3rd Qu.: 0.62787   3rd Qu.: 0.84756   3rd Qu.: 0.39926   3rd Qu.: 0.44615  
#>  Max.   : 3.76407   Max.   : 3.86563   Max.   : 3.70080   Max.   : 3.90663  
#>       y3t2               y4t2               y1t3               y2t3        
#>  Min.   :-2.79230   Min.   :-2.86353   Min.   :-2.11082   Min.   :-2.8872  
#>  1st Qu.:-0.86381   1st Qu.:-0.73574   1st Qu.:-0.70661   1st Qu.:-0.7164  
#>  Median :-0.07609   Median :-0.01785   Median :-0.13864   Median :-0.1077  
#>  Mean   :-0.02135   Mean   : 0.02934   Mean   : 0.08338   Mean   :-0.0426  
#>  3rd Qu.: 0.72667   3rd Qu.: 0.76790   3rd Qu.: 0.68872   3rd Qu.: 0.6607  
#>  Max.   : 3.11985   Max.   : 2.41217   Max.   : 3.48527   Max.   : 2.1115  
#>       y3t3               y4t3               y1t4               y2t4         
#>  Min.   :-2.98815   Min.   :-2.97057   Min.   :-1.65438   Min.   :-1.86385  
#>  1st Qu.:-0.77025   1st Qu.:-0.77634   1st Qu.:-0.71877   1st Qu.:-0.69198  
#>  Median :-0.20686   Median : 0.14041   Median :-0.22838   Median :-0.15266  
#>  Mean   :-0.05228   Mean   : 0.09151   Mean   :-0.04435   Mean   :-0.04778  
#>  3rd Qu.: 0.59804   3rd Qu.: 0.83735   3rd Qu.: 0.37335   3rd Qu.: 0.50632  
#>  Max.   : 3.02163   Max.   : 2.43425   Max.   : 3.55184   Max.   : 2.67729  
#>       y3t4               y4t4               y1t5               y2t5         
#>  Min.   :-3.42380   Min.   :-2.11249   Min.   :-1.52948   Min.   :-2.29685  
#>  1st Qu.:-0.80834   1st Qu.:-0.53783   1st Qu.:-0.63329   1st Qu.:-0.77399  
#>  Median :-0.14044   Median : 0.12070   Median :-0.19444   Median :-0.07924  
#>  Mean   : 0.00369   Mean   : 0.09889   Mean   :-0.03082   Mean   :-0.08537  
#>  3rd Qu.: 0.66979   3rd Qu.: 0.94545   3rd Qu.: 0.37100   3rd Qu.: 0.46914  
#>  Max.   : 3.77293   Max.   : 3.17251   Max.   : 3.60316   Max.   : 3.19776  
#>       y3t5               y4t5         
#>  Min.   :-3.27530   Min.   :-3.00142  
#>  1st Qu.:-0.66808   1st Qu.:-0.44461  
#>  Median :-0.11946   Median : 0.18651  
#>  Mean   :-0.06549   Mean   : 0.07531  
#>  3rd Qu.: 0.48173   3rd Qu.: 0.72227  
#>  Max.   : 3.51018   Max.   : 2.24292
```

## Model Fitting


``` r
fit <- FitCULTA2Profiles(
  data = data,
  wd = ".",
  ncores = parallel::detectCores(),
  mplus_bin = "mplus",
  starts = c(1000, 500),
  stiterations = 200,
  stscale = 2
)
summary(fit)
#> Call:
#> FitCULTA2Profiles(data = data, wd = ".", ncores = parallel::detectCores(), 
#>     mplus_bin = "mplus", starts = c(1000, 500), stiterations = 200, 
#>     stscale = 2)
#>               est     se        z      p    2.5%   97.5%
#> mu_10      2.3395 0.1224  19.1131 0.0000  2.0996  2.5794
#> mu_20      1.5719 0.1226  12.8200 0.0000  1.3316  1.8122
#> mu_30      1.6846 0.1372  12.2813 0.0000  1.4157  1.9534
#> mu_40      1.3490 0.1327  10.1641 0.0000  1.0889  1.6092
#> lambda_t2  1.9233 0.3588   5.3608 0.0000  1.2201  2.6264
#> lambda_s2  0.9664 0.0442  21.8842 0.0000  0.8799  1.0530
#> lambda_t3  1.3077 0.4467   2.9276 0.0034  0.4322  2.1831
#> lambda_s3  0.9821 0.0547  17.9546 0.0000  0.8748  1.0893
#> lambda_t4  1.6569 0.4640   3.5709 0.0004  0.7475  2.5663
#> lambda_s4  0.9985 0.0470  21.2494 0.0000  0.9064  1.0906
#> theta_11   0.1268 0.0129   9.8305 0.0000  0.1015  0.1521
#> theta_22   0.1399 0.0111  12.6190 0.0000  0.1182  0.1616
#> theta_33   0.1668 0.0141  11.8079 0.0000  0.1391  0.1945
#> theta_44   0.1470 0.0115  12.7641 0.0000  0.1245  0.1696
#> phi_0     -0.2017 0.0886  -2.2750 0.0229 -0.3754 -0.0279
#> psi_t      0.0615 0.0268   2.2950 0.0217  0.0090  0.1140
#> psi_p_11   0.1048 0.0193   5.4260 0.0000  0.0669  0.1426
#> psi_p_22   0.0000 0.0000 100.0000 0.0000  0.0000  0.0000
#> psi_p_33   0.6144 0.0928   6.6237 0.0000  0.4326  0.7962
#> psi_p_44   0.5606 0.0883   6.3481 0.0000  0.3876  0.7337
#> psi_s0     0.7241 0.1310   5.5262 0.0000  0.4673  0.9809
#> psi_s      0.2275 0.0203  11.2096 0.0000  0.1877  0.2672
#> mu_11     -0.2637 0.0525  -5.0239 0.0000 -0.3666 -0.1608
#> mu_21     -0.2231 0.0576  -3.8759 0.0001 -0.3359 -0.1103
#> mu_31     -0.2369 0.0920  -2.5743 0.0100 -0.4173 -0.0565
#> mu_41     -0.0747 0.0928  -0.8048 0.4209 -0.2566  0.1072
#> phi_1      0.2840 0.0811   3.5000 0.0005  0.1250  0.4431
#> nu_0      -3.7598 0.9900  -3.7978 0.0001 -5.7002 -1.8194
#> alpha_0   -3.8101 0.4795  -7.9456 0.0000 -4.7500 -2.8703
#> kappa_0    0.1431 0.0698   2.0487 0.0405  0.0062  0.2799
#> beta_00    4.4884 1.0529   4.2630 0.0000  2.4248  6.5520
#> gamma_00  -0.1177 0.0587  -2.0056 0.0449 -0.2328 -0.0027
#> gamma_10   0.1138 0.0357   3.1829 0.0015  0.0437  0.1839
```
